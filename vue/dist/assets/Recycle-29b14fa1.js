import{u as M,b as j}from"./vue-router-1dc8d1b4.js";import{_ as E}from"./index-d9849074.js";import{j as P,r as k,ah as v,o as i,c as u,a as s,V as h,P as d,T as g,O as y,F as C,S as m,U as I,u as w,bm as U,bk as H}from"./@vue-b3e19c9c.js";import"./element-plus-a4c2990b.js";import"./lodash-es-2e98bc53.js";import"./@vueuse-1ae0f1a6.js";import"./@element-plus-f64d54a8.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-7b3af433.js";import"./aplayer-d80f7f58.js";import"./async-validator-10c6301d.js";import"./memoize-one-297ddbcb.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-ac9e5c57.js";import"./vue-cookies-9b55b892.js";import"./@highlightjs-38e4bee3.js";import"./highlight.js-0b7b0786.js";import"./axios-a342f982.js";import"./docx-preview-30c6d22b.js";import"./jszip-d9c085e9.js";import"./xlsx-04f2268f.js";import"./vue-pdf-embed-2320b362.js";import"./vue-336b0872.js";import"./dplayer-ff9c2365.js";import"./vue-clipboard3-abb1cd37.js";import"./clipboard-2fdbe17c.js";const T=p=>(U("data-v-e8a56292"),p=p(),H(),p),A={class:"top"},G=T(()=>s("span",{class:"iconfont icon-revert"},null,-1)),J=T(()=>s("span",{class:"iconfont icon-del"},null,-1)),K={class:"file-list"},Q=["onMouseenter","onMouseleave"],W=["title"],X={class:"op"},Y=["onClick"],Z=["onClick"],ee={key:0},te={__name:"Recycle",emits:["reload"],setup(p,{emit:N}){const{proxy:l}=P();M(),j();const n={loadDataList:"/recycle/loadRecycleList",delFile:"/recycle/delFile",recoverFile:"/recycle/recoverFile"},F=[{label:"文件名",prop:"fileName",scopedSlots:"fileName"},{label:"删除时间",prop:"recoveryTime",width:200},{label:"大小",prop:"fileSize",scopedSlots:"fileSize",width:200}],c=k({}),R={extHeight:20,selectType:"checkbox"},r=async()=>{let e={pageNo:c.value.pageNo,pageSize:c.value.pageSize};e.category!=="all"&&delete e.filePid;let o=await l.Request({url:n.loadDataList,params:e});o&&(c.value=o.data)},x=e=>{c.value.list.forEach(o=>{o.showOp=!1}),e.showOp=!0},z=e=>{e.showOp=!1},a=k([]),O=e=>{a.value=[],e.forEach(o=>{a.value.push(o.fileId)})},B=e=>{l.Confirm(`你确定要还原【${e.fileName}】吗？`,async()=>{await l.Request({url:n.recoverFile,params:{fileIds:e.fileId}})&&r()})},$=()=>{a.value.length!=0&&l.Confirm("你确定要还原这些文件吗？",async()=>{await l.Request({url:n.recoverFile,params:{fileIds:a.value.join(",")}})&&r()})},S=N,q=e=>{l.Confirm(`你确定要删除【${e.fileName}】？`,async()=>{await l.Request({url:n.delFile,params:{fileIds:e.fileId}})&&(r(),S("reload"))})},D=e=>{a.value.length!=0&&l.Confirm("你确定要删除选中的文件?删除将无法恢复",async()=>{await l.Request({url:n.delFile,params:{fileIds:a.value.join(",")}})&&(r(),S("reload"))})};return(e,o)=>{const b=v("el-button"),f=v("icon"),L=v("Table");return i(),u("div",null,[s("div",A,[h(b,{type:"success",disabled:a.value.length==0,onClick:$},{default:d(()=>[G,g("还原 ")]),_:1},8,["disabled"]),h(b,{type:"danger",disabled:a.value.length==0,onClick:D},{default:d(()=>[J,g("删除 ")]),_:1},8,["disabled"])]),s("div",K,[h(L,{columns:F,showPagination:!0,dataSource:c.value,fetch:r,options:R,onRowSelected:O},{fileName:d(({index:V,row:t})=>[s("div",{class:"file-item",onMouseenter:_=>x(t),onMouseleave:_=>z(t)},[(t.fileType==3||t.fileType==1)&&t.status!==0?(i(),y(f,{key:0,cover:t.fileCover},null,8,["cover"])):(i(),u(C,{key:1},[t.folderType==0?(i(),y(f,{key:0,fileType:t.fileType},null,8,["fileType"])):m("",!0),t.folderType==1?(i(),y(f,{key:1,fileType:0})):m("",!0)],64)),s("span",{class:"file-name",title:t.fileName},[s("span",null,I(t.fileName),1)],8,W),s("span",X,[t.showOp&&t.fileId?(i(),u(C,{key:0},[s("span",{class:"iconfont icon-revert",onClick:_=>B(t)},"还原",8,Y),s("span",{class:"iconfont icon-del",onClick:_=>q(t)},"删除",8,Z)],64)):m("",!0)])],40,Q)]),fileSize:d(({index:V,row:t})=>[t.fileSize?(i(),u("span",ee,I(w(l).Utils.size2Str(t.fileSize)),1)):m("",!0)]),_:1},8,["dataSource"])])])}}},xe=E(te,[["__scopeId","data-v-e8a56292"]]);export{xe as default};
